{# social/posts/create_blog_post.html #}
{% extends "base.html" %}
{% load static %}

{% block extra_head %}
  {# Insere o CSS do EasyMDE no head da página #}
  <link rel="stylesheet" href="https://unpkg.com/easymde/dist/easymde.min.css">
{% endblock %}

{% block content %}
<div class="container mx-auto py-8 max-w-2xl">
  <h1 class="text-2xl font-bold mb-4">Criar Post no Estilo Blog</h1>
  <form method="post" enctype="multipart/form-data" class="space-y-6">
    {% csrf_token %}
    {# Renderiza os campos do formulário com os estilos definidos pelo mixin #}
    {{ form.as_div|safe }}
    <div class="text-center">
      <button type="submit" class="btn btn-primary">Criar Post</button>
    </div>
  </form>
</div>
{% endblock %}

{% block extra_scripts %}
  {# Insere o JS do EasyMDE a partir do CDN #}
  <script src="https://unpkg.com/easymde/dist/easymde.min.js"></script>
  <script>
    // Aguarda o carregamento do DOM para inicializar o EasyMDE
    window.onload = function() {
      console.log('Window loaded. Inicializando EasyMDE...');
      // Seleciona o textarea com o atributo name="content"
      var textarea = document.querySelector('textarea[name="content"]');
      if (textarea) {
        console.log('Textarea encontrado:', textarea);
        // Cria uma instância do EasyMDE para transformar o textarea em editor markdown
        var easyMDE = new EasyMDE({
          element: textarea,
          spellChecker: false,  // Desativa o corretor ortográfico para simplificar
          toolbar: [
            "bold", "italic", "heading", "|", "quote", 
            "unordered-list", "ordered-list", "|", "link", 
            "|", "preview"
          ]
        });
        console.log('EasyMDE inicializado com sucesso.');
      } else {
        console.log('Textarea com name "content" não foi encontrado.');
      }
    };
  </script>
{% endblock %}
